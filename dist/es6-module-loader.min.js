/*!
*  es6-module-loader - v0.2.2 - 7/15/2013
*  https://github.com/ModuleLoader/es6-module-loader
*  Copyright (c) 2013 Guy Bedford, Luke Hoban, Addy Osmani; Licensed MIT
*/
!function(global){function Loader(a){var b=function(){};b.prototype=a.global||window,this._builtins=new b;for(var c={},d=["addEventListener","removeEventListener","getComputedStyle","setTimeout","setInterval"],e=0;e<d.length;e++)!function(a){c[a]=function(){return window[a].apply(window,arguments)}}(d[e]);this.defineBuiltins(c),b=function(){},b.prototype=this._builtins,this._global=new b,Object.defineProperty(this._global,"window",{value:this._global}),this._strict=!!a.strict,this.normalize=a.normalize||global.System.normalize,this.resolve=a.resolve||global.System.resolve,this.fetch=a.fetch||global.System.fetch,this.translate=a.translate||global.System.translate,this.link=a.link||global.System.link,this._mios={},this._sloaded={},this._mloads={},this._sloads={}}function Module(a){if("object"!=typeof a)throw new TypeError("Expected object");if(a instanceof Module)return a;var b=this;for(var c in a)!function(c){Object.defineProperty(b,c,{configurable:!1,enumerable:!0,get:function(){return a[c]}})}(c)}Object.defineProperty(Loader.prototype,"global",{configurable:!0,enumerable:!0,get:function(){return this._global}}),Loader.prototype.load=function(a,b,c){var d=this;if(a instanceof Array)for(var e=0,f=0;f<a.length;f++)!function(f){d.load(a[f],function(){e++,e==a.length&&b&&b()},c)}(f);else{if(this._sloaded[a])return b&&b(),void 0;if(this._sloads[a])return this._sloads[a].push({callback:b,errback:c}),void 0;this._sloads[a]=[{callback:b,errback:c}];var g=function(){for(var b=0;b<d._sloads[a].length;b++)d._sloads[a][b].callback&&d._sloads[a][b].callback();delete d._sloads[a]},h=function(b){for(var c=!0,e=0;e<d._sloads[a].length;e++)d._sloads[a][e].errback?d._sloads[a][e].errback(b):c=!1;if(delete d._sloads[a],!c)throw b};this.fetch(a,function(b){var c={address:a,type:"script"};b=d.translate(b,c),d._linkExecute(a,b,c,g,h,!0)},h)}},Loader.prototype.import=function(a,b,c,d){var e=this;if(a instanceof Array)for(var f=[],g=0,e=this,h=0;h<a.length;h++)!function(d){e.import(a[d],function(c){f[d]=c,g++,g==a.length&&b&&b.apply(null,f)},c)}(h);else{a=this.normalize(a,d);var i={referer:d,metadata:"object"==typeof a?a.metadata:null};if("string"!=typeof a&&(a=a.normalized),this._mios[a])return b&&b(this._mios[a]);if(this._mloads[a])return this._mloads[a].push({callback:b,errback:c}),void 0;this._mloads[a]=[{callback:b,errback:c}];var j=function(b){e._mios[a]=b;for(var c=0;c<e._mloads[a].length;c++)e._mloads[a][c].callback&&e._mloads[a][c].callback(b);delete e._mloads[a]},k=function(b){for(var c=!0,d=0;d<e._mloads[a].length;d++)e._mloads[a][d].errback?e._mloads[a][d].errback(b):c=!1;if(delete e._mloads[a],!c)throw b},l=this.resolve(a,i);"string"!=typeof l&&(l=l.address),i.normalized=a,this.fetch(l,function(b){i.address=l,i.type="module",b=e.translate(b,i),e._linkExecute(a,b,i,j,k)},k,i)}};var evalCnt=0;Loader.prototype._linkExecute=function(a,b,c,d,e){a||(a="__eval"+evalCnt++);var f="script"==c.type,g=this.link(b,c);if(g instanceof Module&&!f)return d(g);var h=this;ES6Parser.loadEsprima(a,b,function(){var i,j;if("object"!=typeof g||f?i=ES6Parser.parseImports(a,b):(i=g.imports,j=g.execute),!e.called){var k=b,l={};if(j=j||function(){var b;return b=ES6Parser.parseEval(k,h,{name:a,normalizeMap:l,sourceURL:c.address,isEval:f}),a&&!f?new Module(b||{}):void 0},!i.length)return d(j.call(h));for(var m=[],n=0,o=0;o<i.length;o++)!function(b){var f={name:a,address:c.address},g=h.normalize(i[b],f);"object"==typeof g&&(g=g.normalized),l[i[b]]=g,h.import(i[b],function(a){if(n++,m[b]=a,n==i.length)try{var c=j.apply(h,m);d(c)}catch(f){return e(f),void 0}},e,f)}(o)}},e)},Loader.prototype.eval=function(a){ES6Parser.parseEval(a,this,{isEval:!0})},Loader.prototype.evalAsync=function(a,b,c){this._linkExecute(null,a,{type:"script"},b||function(){},c||function(){})},Loader.prototype.get=function(a){return this._mios[a]||null},Loader.prototype.set=function(a,b){this._mios[a]=Module(b)},Loader.prototype.has=function(a){return!!this._mios[a]},Loader.prototype.delete=function(a){delete this._mios[a]},Loader.prototype.defineBuiltins=function(a){for(var b in a)a.hasOwnProperty(b)&&(this._builtins[b]=a[b])};var absUrlRegEx=/^\/|([^\:\/]*:\/\/)/,isUrl=function(a){return".js"==a.substr(a.length-3,3)||a.match(absUrlRegEx)},defaultSystemLoader=new Loader({global:window,strict:!1,normalize:function(a,b){if(isUrl(a))return a;var c=b&&b.name;if("./"==a.substr(0,2)){var d=c.split("/");return d.length?(d.pop(),d.push(a.substr(2)),d.join("/")):a.substr(2)}if("../"==a.substr(0,3)){var d=c.split("/");if(!d.length)throw"Path below baseUrl";return d.pop(),this.normalize("./"+a.substr(3),{name:d.join("/")})}return a},resolve:function(a){for(var b in this.ondemandTable)if(-1!=this.ondemandTable[b].indexOf(a))return a;return isUrl(a)?a:this.baseURL+("/"!=this.baseURL.substr(this.baseURL.length-1,1)?"/":"")+a+(".js"==a.substr(a.length-3,3)?"":".js")},fetch:function(a,b,c){var d=new XMLHttpRequest;d.onreadystatechange=function(){4===d.readyState&&(200===d.status||0==d.status&&d.responseText?b(d.responseText):c(d.statusText||"XHR error"))},d.open("GET",a,!0),d.send(null)},translate:function(a){return a},link:function(){}});defaultSystemLoader.baseURL=document.URL.substring(0,window.location.href.lastIndexOf("/")+1),defaultSystemLoader.ondemandTable={},defaultSystemLoader.ondemand=function(a){for(var b in a)this.ondemandTable[b]=this.ondemandTable[b]||[],a[b]instanceof Array?this.ondemandTable[b]=this.ondemandTable[b].concat(a[b]):this.ondemandTable[b].push(a[b])};var scripts=document.getElementsByTagName("script"),curPath=scripts[scripts.length-1].src,basePath=curPath.substr(0,curPath.lastIndexOf("/")+1),ES6Parser={traverse:function(a,b){var c,d;if(b(a)!==!1)for(c in a)d=a[c],"object"==typeof d&&null!==d&&this.traverse(d,b)},importRegEx:/^\s*import\s+./m,exportRegEx:/^\s*export\s+(\{|\*|var|class|function|default)/m,moduleRegEx:/^\s*module\s+("[^"]+"|'[^']+')\s*\{/m,checkModuleSyntax:function(a,b){return(null==a||void 0===this.parseNames[a])&&(this.parseNames[a]=b&&!!(b.match(this.importRegEx)||b.match(this.exportRegEx)||b.match(this.moduleRegEx))),this.parseNames[a]},loadEsprima:function(a,b,c){if(this.esprima)return c();if(!this.polyfills.length&&!this.checkModuleSyntax(a,b))return c();var d=this;System.load(basePath+"esprima-es6.min.js",function(){d.esprima=System.global.esprima,c()})},parseNames:{},treeCache:{},parseImports:function(a,b){if(!this.checkModuleSyntax(a,b))return[];var c=this.treeCache[a]||(this.treeCache[a]=this.esprima.parse(b,{range:!0})),d=[];return this.traverse(c,function(a){"ImportDeclaration"==a.type?d.push(a.source.value):"ExportDeclaration"==a.type&&a.source&&d.push(a.source.value)}),d},addPolyfill:function(a){this.loadEsprima(null,null,function(){},function(){}),this.polyfills.push(a)},polyfills:[],applyPolyfill:function(a,b){for(var c=0;c<this.polyfills.length;c++)this.polyfills[c](a,b)},parseEval:function(source,loader,opt){if(!this.polyfills.length&&!this.checkModuleSyntax(opt.name,source)){var __Loader=loader;return eval("(function(window) { with(__Loader.global) { "+(loader._strict?'"use strict";\n':"")+source+" } }).call(__Loader.global, __Loader.global); "+(opt.sourceURL?"\n//# sourceURL="+opt.sourceURL:"")),void 0}var tree=this.treeCache[opt.name]||this.esprima.parse(source,{range:!0}),normalizeMap=opt.normalizeMap||{},tSource=new SourceModifier(source),self=this;this.traverse(tree,function(a){if("ImportDeclaration"==a.type){var b=normalizeMap[a.source.value]||a.source.value;if("default"==a.kind)tSource.replace(a.range[0],a.range[1],"var "+a.specifiers[0].id.name+" = __Loader.get('"+b+"')['default'];");else{for(var c="var __module = __Loader.get('"+b+"');",d=0;d<a.specifiers.length;d++){var e=a.specifiers[d];c+="var "+(e.name?e.name.name:e.id.name)+" = __module['"+e.id.name+"'];"}tSource.replace(a.range[0],a.range[1],c)}}else if("ExportDeclaration"==a.type)if(console.log(a),a.declaration)if("VariableDeclaration"==a.declaration.type){var f=a.declaration.declarations[0];f.init?tSource.replace(a.range[0],f.init.range[0]-1,"__exports['"+f.id.name+"'] = "):tSource.replace(a.range[0],f.id.range[0]-1,"__exports['"+f.id.name+"'] = ")}else("FunctionDeclaration"==a.declaration.type||"ClassDeclaration"==a.declaration.type)&&tSource.replace(a.range[0],a.declaration.range[0]-1,"__exports['"+a.declaration.id.name+"'] = ");else if(a.source){var b=normalizeMap[a.source.value]||a.source.value;if("ExportBatchSpecifier"==a.specifiers[0].type)tSource.replace(a.range[0],a.range[1],"var __module = __Loader.get('"+b+"'); for (var m in __module) { __exports[m] = __module[m]; }; ");else{for(var c="var __module = __Loader.get('"+b+"'); ",d=0;d<a.specifiers.length;d++){var e=a.specifiers[d];c+="__exports['"+(e.name?e.name.name:e.id.name)+"'] = __module['"+e.id.name+"']; "}tSource.replace(a.range[0],a.range[1],c)}}else{for(var c="",d=0;d<a.specifiers.length;d++){var e=a.specifiers[d];c+="__exports['"+e.id.name+"'] = "+(e.name?e.name.name:e.id.name)+"; "}tSource.replace(a.range[0],a.range[1],c)}else"ModuleDeclaration"==a.type&&"BlockStatement"==a.body.type?(tSource.replace(a.range[0],a.body.range[0]+1,"(function() { var __exports = {}; "),tSource.replace(a.body.range[1],a.range[1]," __Loader.set('"+a.id.name+"', new Module(__exports)); })();")):self.polyfills.length&&self.applyPolyfill(a,tSource)}),delete this.treeCache[opt.name];var __Loader=loader,__exports={},evalSource="(function(window) { with(__Loader.global) { "+(loader._strict?'"use strict";\n':"")+tSource.toString()+" } }).call(__Loader.global, __Loader.global);"+(opt.sourceURL?"\n//# sourceURL="+opt.sourceURL:"");if(eval(evalSource),opt.isEval)for(var e in __exports)throw"Exports only supported for modules, not script evaluation.";return __exports}},SourceModifier=function(a){this.source=a,this.rangeOps=[]};SourceModifier.prototype={mapIndex:function(a){for(var b=0;b<this.rangeOps.length;b++){var c=this.rangeOps[b];if(!(c.start>=a)){if(!(c.end<=a))throw"Source location "+a+" has already been transformed!";a+=c.diff}}return a},replace:function(a,b,c){var d=c.length-(b-a+1);a=this.mapIndex(a),b=this.mapIndex(b),this.source=this.source.substr(0,a)+c+this.source.substr(b+1),this.rangeOps.push({start:a,end:b,diff:d})},getRange:function(a,b){return this.source.substr(this.mapIndex(a),this.mapIndex(b))},toString:function(){return this.source}},global.Loader=Loader,global.Module=Module,global.System=defaultSystemLoader}(window);