/*
 *  es6-module-loader v1.0.0-alpha
 *  https://github.com/ModuleLoader/es6-module-loader
 *  Copyright (c) 2015 Guy Bedford, Luke Hoban, Addy Osmani; Licensed MIT
 */

!function(a){function b(){this._loader={loaderObj:this,resolve:void 0,fetch:void 0,translate:void 0,instantiate:void 0,registry:{}}}function c(a,b,c){return a.registry[b]||(a.registry[b]={key:b,state:H,metadata:c||{},fetch:void 0,translate:void 0,instantiate:void 0,fetchResolve:void 0,translateResolve:void 0,instantiateResolve:void 0,dependencies:void 0,module:void 0,declare:void 0,error:null})}function d(a,b,c){b.fetchResolve?b.fetchResolve(c):b.fetch=E.resolve(c),b.fetchResolve=void 0,b.state=Math.max(b.state,I)}function e(a,b,c){b.translateResolve?b.translateResolve(c):b.translate=E.resolve(c),b.translateResolve=void 0,b.state=Math.max(b.state,J)}function f(a,b,c,d){if(void 0===c)var e=r(a.loaderObj,b.key,d,b.metadata);else if("function"!=typeof c)throw new TypeError("Instantiate must return an execution function.");b.instantiateResolve?b.instantiateResolve(c):b.instantiate=E.resolve(c),b.instantiateResolve=void 0;var f=[];if(void 0===c){b.declare=e.declare;for(var g=0;g<e.deps.length;g++)f.push({key:e.deps[g],value:void 0})}b.dependencies=f,b.module=c,b.state=Math.max(b.state,K)}function g(a,b,c,d){return E.resolve(void 0===c&&u(a.loaderObj)).then(function(){f(a,b,c,d)})}function h(a,b,e,f){return f=f||c(a,b,e),f.error?E.reject(f.error):f.state===M?E.reject(new Error(b+" cannot be fetched as it is already linked.")):f.fetch?f.fetch:(E.resolve().then(function(){return a.fetch.call(a.loaderObj,b,f.metadata)}).then(function(b){d(a,f,b)},function(a){throw p(a,"Fetching "+b)})["catch"](function(a){f.error=f.error||a}).then(function(){f.error&&f.fetchResolve&&f.fetchResolve(E.reject(f.error))}),f.fetch=new E(function(a){f.fetchResolve=a}))}function i(a,b,d,f){return f=f||c(a,b,d),f.error?E.reject(f.error):f.state===M?E.reject(new Error(b+" cannot initiate translate as it is already linked.")):f.translate?f.translate:(h(a,b,null,f).then(function(c){return E.resolve().then(function(){return a.translate.call(a.loaderObj,b,c,f.metadata)}).then(function(b){e(a,f,b)},function(a){throw p(a,"Translating "+b)})})["catch"](function(a){f.error=f.error||a}).then(function(){f.error&&f.translateResolve&&f.translateResolve(E.reject(f.error))}),f.translate=new E(function(a){f.translateResolve=a}))}function j(a,b,d,e){return e=e||c(a,b,d),e.error?E.reject(e.error):e.state===M?E.reject(new Error(b+" cannot instantiate as it is already linked.")):e.instantiate?e.instantiate:(i(a,b,null,e).then(function(c){return E.resolve().then(function(){return a.instantiate.call(a.loaderObj,b,c,e.metadata)}).then(function(b){return g(a,e,b,c)},function(a){throw p(a,"Instantiating "+b)})})["catch"](function(a){e.error=e.error||a}).then(function(){e.error&&e.instantiateResolve&&e.instantiateResolve(E.reject(e.error))}),e.instantiate=new E(function(a){e.instantiateResolve=a}))}function k(a,b,d,e){return e=e||c(a,b,d),e.state>K?e:j(a,b,null,e).then(function(){e.state=Math.max(e.state,L);for(var d=[],f=0;f<e.dependencies.length;f++)(function(e){var f={};d.push(E.resolve(a.resolve.call(a.loaderObj,e.key,b,f)).then(function(b){var d=c(a,b,f);return e.value=d,k(a,b,null,d)}))})(e.dependencies[f]);return E.all(d)["catch"](function(a){throw a=p(a,"Loading "+b),e.error=e.error||a,a})})}function l(a,b,d,e){return e=e||c(a,b,d),e.error?E.reject(e.error):e.state===M?E.resolve(e):k(a,b,d,e).then(function(){var a=[];n(e,a);for(var b=0;b<a.length;b++){var c=a[b];c.state==L&&"function"==typeof c.module&&(o(c),c.state=M)}return e.state==L&&declareModule(e),e})["catch"](function(a){throw e.error=a,a})}function m(a,b,d,e){return e=e||c(a,b,d),l(a,b,d,e).then(function(a){var c=a.module;if(c instanceof q)return c;var d=ensureModuleExecution(c,[]);if(d)throw d=p(d,"Error evaluating "+b),a.error=d,d;return c.module},function(a){throw e.error=e.error||a,a})}function n(a,b){if(-1==F.call(b,a)){b.push(a);for(var c=0;c<a.dependencies.length;c++)n(a.dependencies[c].value,b)}}function o(a){if(a.error)throw a.error;try{a.module=a.module()}catch(b){throw a.error=b,b}}function p(a,b){var c;if(a instanceof Error){var c=new a.constructor(a.message,a.fileName,a.lineNumber);c.message=a.message+"\n  "+b,c.stack=a.stack}else c=a+"\n  "+b;return c}function q(a){for(var b in a)this[b]=a[b]}function r(){throw new TypeError("Native ES Module support not included in this loader.")}function s(){}function t(b){try{a.traceur?b.install("traceur",new q({"default":a.traceur})):a.babel&&b.install("babel",new q({"default":a.babel}))}catch(c){}}function u(a){S&&(t(a),S=!1);var b=a.transpiler;if(b!==O||!P)return O=b,P=Q=null,a["import"](b).then(function(a){P=a["default"]})}function r(a,b,c,d){return y(b,(P.Compiler?v:x)(P,b,c,d))}function s(b,c){var d=this;return E.resolve(O===d.transpiler&&Q||d.resolve(O=d.transpiler)).then(function(e){return Q=e,Q===b?function(){var e=a.System,f=a.Reflect.Loader;return z(b,"~function(require,exports,module){"+c+"}()"),a.System=e,a.Reflect.Loader=f,new q({"default":a[d.transpiler]})}:void 0})}function v(a,b,c,d){var e=this.traceurOptions||{};e.modules="instantiate",e.script=!1,e.sourceMaps="inline",e.inputSourceMap=d.sourceMap,e.filename=b,e.inputSourceMap=d.sourceMap,e.moduleName=!1;var f=new a.Compiler(e),c=w(c,f,e.filename);return c+"!eval"}function w(a,b,c){try{return b.compile(a,c)}catch(d){throw d[0]||d}}function x(a,b,c){var d=this.babelOptions||{};d.modules="system",d.sourceMap="inline",d.filename=b,d.code=!0,d.ast=!1,d.blacklist||(d.blacklist=["react"]);var c=a.transform(c,d).code;return c+"\n//# sourceURL="+b+"!eval"}function y(b,c){var d,e=a.System=a.System||X,f=e.register;return e.register=function(a,b){d={deps:a,declare:b}},z(b,'var __moduleURL = "'+b+'";'+c,{}),e.register=f,d}function z(a,b,c){try{new Function(b).call(c)}catch(d){throw("SyntaxError"==d.name||"TypeError"==d.name)&&(d.message="Evaluating "+a+"\n	"+d.message),d}}function A(a,b){if("string"!=typeof a)throw new TypeError("URL must be a string");var c=String(a).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(?:\/\/(?:([^:@\/?#]*)(?::([^:@\/?#]*))?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);if(!c)throw new RangeError;var d=c[1]||"",e=c[2]||"",f=c[3]||"",g=c[4]||"",h=c[5]||"",i=c[6]||"",j=c[7]||"",k=c[8]||"",l=c[9]||"";if(void 0!==b){var m=b instanceof A?b:new A(b),n=""===d&&""===g&&""===e;n&&""===j&&""===k&&(k=m.search),n&&"/"!==j.charAt(0)&&(j=""!==j?(""===m.host&&""===m.username||""!==m.pathname?"":"/")+m.pathname.slice(0,m.pathname.lastIndexOf("/")+1)+j:m.pathname);var o=[];j.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(a){"/.."===a?o.pop():o.push(a)}),j=o.join("").replace(/^\//,"/"===j.charAt(0)?"/":""),n&&(i=m.port,h=m.hostname,g=m.host,f=m.password,e=m.username),""===d&&(d=m.protocol)}this.origin=d+(""!==d||""!==g?"//":"")+g,this.href=d+(""!==d||""!==g?"//":"")+(""!==e?e+(""!==f?":"+f:"")+"@":"")+g+j+k+l,this.protocol=d,this.username=e,this.password=f,this.host=g,this.hostname=h,this.port=i,this.pathname=j,this.search=k,this.hash=l,"file"==this.protocol&&(this.pathname=this.pathname.replace(/\\/g,"/"))}function B(){}function C(){document.removeEventListener("DOMContentLoaded",C,!1),window.removeEventListener("load",C,!1),D()}function D(){for(var a=document.getElementsByTagName("script"),b=0,c=0;c<a.length;c++){var d=a[c];if("module"==d.type){var e=d.src;e?X.load(e,"ready"):(X.provide("anon"+ ++b,"fetch",d.innerHTML.substr(1)),X.load("anon"+b,"ready"))}}}var E=a.Promise||require("when/es6-shim/Promise"),F=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},G="object"==typeof exports&&"function"==typeof require,H=0,I=1,J=2,K=3,L=4,M=5;b.prototype["import"]=function(a,b){var c=this._loader,d={};return E.resolve().then(function(){return c.resolve.call(c.loaderObj,a,b,d)})["catch"](function(c){throw p(c,"Resolving "+a+(b?", "+b:""))}).then(function(a){return m(c,a,d)})},b.prototype.resolve=function(a,b,c){var d=this._loader;return d.resolve.call(d.loaderObj,a,b,c||{})},b.prototype.load=function(a,b,c){var d=this._loader;if("fetch"==b)return h(d,a,c);if("translate"==b)return i(d,a,c);if("instantiate"==b)return k(d,a,c).then(function(a){return a.module instanceof q?void 0:a.module});if("link"==b)return l(d,a,c).then(function(){});if(b&&"ready"!=b)throw new TypeError("Invalid stage "+b);return m(d,a,c).then(function(a){return a.module})},b.prototype.provide=function(a,b,f,h){var i=this._loader,j=c(i,a,h);if("fetch"==b){if(j.state>H)throw new TypeError(a+" has already been fetched.");d(i,j,f)}else if("translate"==b){if(j.state>I)throw new TypeError(a+" has already been translated.");e(i,j,f)}else{if("instantiate"!=b)throw new TypeError("Invalid stage "+b);if(j.state>J)throw new TypeError(a+" has already been instantiated.");d(i,j,void 0),e(i,j,void 0),j.translate.then(function(a){g(i,j,f,a)})}},b.prototype.error=function(){},b.prototype.lookup=function(a){var b=this._loader,c=b.registry[a];if(!c)return null;var d;return c.state==H?d="fetch":c.state==I?d="translate":c.state==J?d="instantiate":c.state==L?d="link":c.state==M&&(d="ready"),{state:d,metadata:c.metadata,fetch:c.fetch&&E.resolve(c.fetch),translate:c.translate&&E.resolve(c.translate),instantiate:c.instantiate&&E.resolve(c.instantiate),module:c.state==M&&(c.module instanceof q?c.module:c.module.module),error:c.error}},b.prototype.install=function(a,b){var c=this._loader;if(c.registry[a])throw new TypeError(a+" is already defined in the Loader registry.");if(!(b instanceof q))throw new TypeError("Install must provide a valid Module object.");c.registry[a]={key:a,state:M,metadata:metadata,fetch:void 0,translate:void 0,instantiate:void 0,dependencies:void 0,module:b,declare:void 0,error:null}},b.prototype.uninstall=function(a){var b=this._loader,c=b.registry[a];if(!c)throw new TypeError(a+" is not defined in the Loader registry.");if(c.state<L)throw new TypeError(a+" is still loading.");delete b.registry[a]},b.prototype.cancel=function(a){var b=this._loader,c=b.registry[a];if(!c)throw new TypeError(a+" does not exist.");if(c.state>=L)throw new TypeError(a+" is already past linking.");delete b.registry[a]};var N=["resolve","fetch","translate","instantiate"];b.prototype.hook=function(a,b){var c=this._loader;if(-1==F.call(N,a))throw new TypeError(a+" is not a valid hook.");return b?void(c[a]=b):c[a]},b.prototype.transpiler="traceur";var O,P,Q,R,S=!0,T="undefined"!=typeof process&&!!process.platform.match(/^win/);if("undefined"!=typeof XMLHttpRequest)R=function(a,b,c){function d(){b(f.responseText)}function e(){c(new Error("GET "+a+" "+f.status+" ("+f.statusText+")"))}var f=new XMLHttpRequest,g=!0,h=!1;if(!("withCredentials"in f)){var i=/^(\w+:)?\/\/([^\/]+)/.exec(a);i&&(g=i[2]===window.location.host,i[1]&&(g&=i[1]===window.location.protocol))}g||"undefined"==typeof XDomainRequest||(f=new XDomainRequest,f.onload=d,f.onerror=e,f.ontimeout=e,f.onprogress=function(){},f.timeout=0,h=!0),f.onreadystatechange=function(){4===f.readyState&&(200===f.status||0==f.status&&f.responseText?d():e())},f.open("GET",a,!0),h&&setTimeout(function(){f.send()},0),f.send(null)};else{if(!G)throw new TypeError("No environment fetch API available.");var U;R=function(a,b,c){if("file:///"!=a.substr(0,8))throw"Only file URLs of the form file: allowed running in Node.";U=U||require("fs"),a=T?a.replace(/\//g,"\\").substr(8):a.substr(7),U.readFile(a,function(a,d){a?c(a):b(d+"")})}}var V=function(){function a(a){for(var b in c){var d="*"===b.charAt(b.length-1);if(d){if(a.substr(0,b.length-1)===b.substr(0,b.length-1))return c[b].replace("*",a.substr(b.length-1,a.length-b.length+1))}else if(a===b)return c[b]}}b.call(this,arguments);var c={};this.site=function(a){for(var b in a)c[b]=a[b]},this.site.get=function(a){return c[a]},this.site.set=function(a,b){c[a]=b},this.site.has=function(a){return!!c[a]},this.site["delete"]=function(a){delete c[a]},this.hook("resolve",function(b,c){var d=a(b);return(d||!c)&&(c=W),new A(d||b,c).href}),this.hook("fetch",function(a){return new E(function(b,c){R(a,b,c)})}),this.hook("translate",function(a,b){return b}),this.hook("instantiate",s)};B.prototype=b.prototype,V.prototype=new B;var W;"undefined"!=typeof document&&document.baseURI?W=document.baseURI:"undefined"!=typeof location&&location.href?W=location.href:"undefined"!=typeof document&&document.getElementsByTagName&&(W=document.getElementsByTagName("base")[0],W=W&&W.href),W?(W=W.split("#")[0].split("?")[0],W=W.substr(0,W.lastIndexOf("/")+1)):"undefined"!=typeof process&&process.cwd&&(W="file://"+(T?"/":"")+process.cwd()+"/",T&&(W=W.replace(/\\/g,"/"))),W=new A(W);var X=new V;if(X.constructor=V,"undefined"!=typeof document&&document.getElementsByTagName){var Y=document.getElementsByTagName("script");Y=Y[Y.length-1],"complete"===document.readyState?setTimeout(D):document.addEventListener&&(document.addEventListener("DOMContentLoaded",C,!1),window.addEventListener("load",C,!1)),Y&&Y.getAttribute("data-init")&&window[Y.getAttribute("data-init")]()}var Z;!function(c){Z=c.Reflect||{},Z.Loader=Z.Loader||b,Z.Module=Z.Module||q,Z.global=Z.global||a,c.LoaderPolyfill=b,c.ModulePolyfill=q,c.Reflect=Z,c.System=X}(G?exports:a)}("undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope?self:global);
//# sourceMappingURL=es6-module-loader.js.map